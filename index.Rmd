---
title: "Gov 50 Final Project"
author: "Tai Ran Tang"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---
## Preparing Data
```{r} 
library(readxl)
sanction <- read_excel("~/Desktop/dataverse_files/IST_JPR_Attia&Grauvogel.xlsx")

library(tidyverse)
data_sanction <- sanction|>
  select(-sender, -target, -startdate, -terdate, -defactoter, -ongoing, -gradual, -datasets, -sourceimp, - sourceter, -instinvestment, -comment, -goals, -costsender) 

data_sanction <- data_sanction |>
  mutate(expiry = case_when(expiry == 0 ~ "no expiry",
                            expiry == 1 ~ "will expire"),
         review = case_when(review == 0 ~ "no review",
                            review == 1 ~ "specific temporal review"),
         adaptgoal = case_when(adaptgoal == 0 ~ "no change",
                            adaptgoal == 1 ~ "adjusted goal"),
         negotiations = case_when(negotiations == 0 ~ "no negotiations",
                            negotiations == 1 ~ "negotiated"),
         saliance = case_when(targetsalience < sendersalience ~ "assymetric stakes",
                             targetsalience == sendersalience~ "equal stakes",
                             targetsalience > sendersalience~ "self-defence stakes"),
         costtarget = case_when(costtarget == "Major" | costtarget == "Severe" ~ "Economically Damaging",
                             costtarget == "Minor" ~ "Minor damages"),
         unfair = if_else(review == "no review" & adaptgoal == "adjusted goal" & expiry == "no expiry", "Unfair", 
                  if_else(review == "no review" & adaptgoal == "adjusted goal" & negotiations == "no negotiations", "Unfair",
                  if_else(review == "no review" & expiry == "no expiry" & negotiations == "no negotiations", "Unfair",
                  if_else(negotiations == "no negotiations" & adaptgoal == "adjusted goal" & expiry == "no expiry", "Unfair",
                    "Fair" )))),
    sender = str_split(caseid, "_", simplify = TRUE)[, 1],
    target = str_split(caseid, "_", simplify = TRUE)[, 2],
    year = str_split(caseid, "_", simplify = TRUE)[, 3],
    year = as.numeric(year), 
    year = if_else(year >= 48, year + 1900, year + 2000)
  )

data_sanction <- data_sanction |>
   mutate_all(~ifelse(. %in% c("Blank"), NA, .)) |> 
    na.omit() |>
  mutate_all(~ifelse(. %in% c("missing"), NA, .)) |> 
    na.omit() |>
  drop_na() |>
   mutate(outcome = case_when(outcome == "Sender capitulation" ~ "Fail",
                              outcome == "Stalemate" ~ "Fail",
                              outcome == "Target complete acquiescence" ~ "Success",
                              outcome == "Target partial acquiescence" ~ "Success",
                             grepl("Negotiated settlement", outcome) ~ "Win-Win" ))  # success defined as sender obtains goals through target partial or complete acquiescence (win-lose), failure defined as sender capitulating to target or target obtaining stalemate (lose-win or lose-lose), win-win defined as negotiated settlement 

# Joining Military Data
library(haven)
cow <- read_dta("~/Downloads/NMC_Supplement_v4_0.dta") |>
  select(stateabb, year, milex, milper)

cow_sender <- cow |>
  rename(sender = stateabb,
         military_expense = milex,
         military_personnel = milper) |>
  mutate(military_personnel =  military_personnel *1000)

cow_target <- cow |>
  rename(target = stateabb,
         military_expense = milex,
         military_personnel = milper) |>
  mutate(military_personnel =  military_personnel *1000)
         
data_sanction <- data_sanction |>
  left_join(cow_sender, by = c("sender", "year")) |>
  left_join(cow_target, by = c("target", "year")) |>
  rename( "Mil_ex_Sender" = "military_expense.x" ,
          "Mil_per_Sender" = "military_personnel.x",
          "Mil_ex_Target" = "military_expense.y",
          "Mil_per_Target" = "military_personnel.y" )

# Joining GDP data
gdp <- read_csv("~/Desktop/API_NY.GDP.MKTP.CD_DS2_en_csv_v2_6011335.csv", show_col_types = FALSE, skip = 4) |>
  pivot_longer(cols = `1960`:`2022`, names_to = "year", values_to = "gdp") |>
  select(`Country Code`, year, gdp) |>
  filter(!is.na(gdp)) |>
  mutate(across(.fns = as.character)) |>
  type_convert()

gdp_sender <- gdp |>
  rename(sender = `Country Code`) |>
  mutate(gdp_in_mils= `gdp`/1000000) |>
  select(-gdp)

gdp_target <- gdp |>
  rename(target = `Country Code`)|>
  mutate(gdp_in_mils = `gdp`/1000000) |>
  select(-gdp)

data_sanction <- data_sanction |>
  left_join(gdp_sender, by = c("sender", "year")) |>
  left_join(gdp_target, by = c("target", "year")) |>
  rename( "GDP of Sender (mils)" = "gdp_in_mils.x" ,
          "GDP of Target (mils)" = "gdp_in_mils.y") 

data_sanction <- data_sanction |>
  mutate(mil_coerc = case_when(Mil_ex_Target/Mil_ex_Target < 0.25 ~ "Overwhelming military superiority",
                               Mil_ex_Target/Mil_ex_Target >= 0.25 | Mil_ex_Target/Mil_ex_Target < 0.5 ~ "Military superiority",
                               Mil_ex_Target/Mil_ex_Target >= 0.5 ~ "Baseline inequality"),
         econ_power = case_when(`GDP of Target (mils)`/`GDP of Sender (mils)` < 0.1 ~ "Sender significantly richer",
                                `GDP of Target (mils)`/`GDP of Sender (mils)` >= 0.1 | `GDP of Target (mils)`/`GDP of Sender (mils)` < 0.5 ~ "Sender slightly richer",
                                `GDP of Target (mils)`/`GDP of Sender (mils)` >= 0.5 ~ "Baseline inequality"))

  
```
Success is defined as sender obtains goals through target partial or complete acquiescence (win-lose), failure is defined as sender capitulating to target or target obtaining stalemate (lose-win or lose-lose), win-win defined as negotiated settlement for both target and sender. 

Unfair is defined as failing 3 of 4 design parameters for the sanction terms of either no review date for santions, no negotiations initiated, no expiry date, or a sender change of goals. These are terms that, when taken together, indicate a lack of interest in engaging with the issue that inspired the sanction and a lack of intention to end the sanction upon successful enforcement of santion terms.

## Visualising Data

```{r fig.height = 5, fig.width = 10}
library(wesanderson)
library(kableExtra)

sanction_effectiveness <- data_sanction |>
   group_by(requirementter, outcome) |>
  summarise(count = n())

effective_plot <- ggplot(sanction_effectiveness, mapping = aes(x = requirementter, y = count, fill = outcome)) +
  geom_col() + labs(title = "Sanction Goal Clarity and Outcome", x = "Sanction Requirements", y = "Count") +
  theme_linedraw()
  
effective_plot + scale_fill_manual(values = wes_palette("GrandBudapest1"))

effective_prop <- sanction_effectiveness |>
  mutate(prop = count/sum(count)) |>
  select(-count) |>
  kbl(caption = "Sanction Goal Clarity and Outcome")  |>
  kable_minimal() |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) 
  
effective_prop

unfairness_test <- data_sanction |>
   group_by(unfair, outcome) |>
  summarise(count = n())

fairness_plot <- ggplot(unfairness_test, mapping = aes(x = outcome, y = count, fill = unfair)) +
  geom_col() + 
  labs(title = "Sanction Unfairness and Outcome", x = "Outcome", y = "Count") +
  theme_linedraw()

fairness_plot + scale_fill_manual(values = wes_palette("GrandBudapest1"))

```

When looking at the graph of Sanction Goal Clarity and Outcome, it shows that the distribution of outcomes remains proportional for both ambiguous and clear terms of sanction. Furthermore, the table for sanction goal clarity and outcome shows that the proportion of fail:success:win-win is similar for ambiguous and clear sanction terms. 

In addition, the graph for the Sanction Unfairness and Outcome shows that majority of the sanctions were fairly designed at least with the definition of fairness defined above. The proportion of fair and unfair sanction design also remains consistent within each outcome, showing that there is an external factor that is affecting the outcome. Taken together, the goal clarity and unfairness eliminates sanction designs itself as explanation for the differences in sanction outcome. Therefore, it points to external forces exerting pressures on sanction outcomes.

```{r fig.height = 5, fig.width = 10}
sender_data <- data_sanction |>
  group_by(sender, outcome) |>
  summarise(count = n())
  
sender_plot <- ggplot(sender_data, mapping = aes(x = reorder(sender, -count), y = count, fill = outcome)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 90)) +
  theme_linedraw() +
  labs(title = "Sanction Senders and Outcomes Sanctions", x = "Senders", y = "Count")

sender_plot + scale_fill_manual(values = wes_palette("GrandBudapest1"))

```
When looking at the graph of sanction senders and their outcomes, the sanction senders proportion clearly highlights the dominance of US initiated sanctions compared to the international organisations. This is one indication of potentially abuse of sanctions based on economic power. The US initiated sanctions have a much lower probability of success --  a greater distribution goes to failures and win-wins. While the majority of senders are multilateral actions taken by international actors, the majority of sanctions sent are initiated by the USA.


fit_sanction <- lm(outcome ~ treat_ind + vf_age + vf_racename + vf_female + vf_democrat + therm_trans_t0 + canvasser_trans, data = trans)

modelsummary::modelsummary(fit_ate,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared", "adj.r.squared"))











## Random notes

This table is a rough overview of some hypothesised indicators in the sanction terms that might indicate unfair sanctions. Specifically, the combination of no review timeline, no expiry, no negotiations, and goal adjustment indicate a breakdown in communications between sender and target, and is the most forceful in achieving desired sanction goals.^[Julio Solis, Book 1] 

See this book [(Solis 2023)](https://www.openai.com/)


### Action item: The theory for sanction terms is currently lacking as it is only a hypothesis, and would thus require secondary readings to prove that these are sound indicators of unfair sanctions.


```{r}
sanction_effectiveness <- data_sanction |>
   group_by(requirementter, outcome) |>
  summarise(count = n())

effective_plot <- ggplot(sanction_effectiveness, mapping = aes(x = requirementter, y = count, fill = outcome)) +
  geom_col() + labs(title = "Sanction Goal Clarity and Outcome", x = "Sanction Requirements", y = "Count")
  
effective_plot


```
This last plot helps to establish a baseline of sanction effectiveness. While there are significantly more sanctions with clear  requirements that have succeeded, it is important to note that the proportion of fails, success and win-wins remains constant regardless of the clarity of sanction requirement. This means that differences in outcome relies on external factors beyond sanction terms, which exposes sanctions to more external factors that could be affected by geopolitical wills or simply the rule of might is right. 

### Action item: It would be interesting to treat sanction outcome with the issue salience as well to check whether the compliance with sanctions has more to do with the interests of the sender and target. It would reveal whether the outcome is more significntly explained by its own terms, or by external factors. It would also be interesting to perform regression analysis to test for significance, p-value and r-squared to check the significance in explanability.

## Analysis

I have downloaded data here https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/SVR5W7 
Attia, Hana; Julia Grauvogel, 2022, "International Sanctions Termination Dataset", https://doi.org/10.7910/DVN/SVR5W7, Harvard Dataverse, V1

# Preamble:
Steven Pinker argued in "The Better Angels of Our Nature: Why Violence Has Declined" that the world is currently in the most peaceful era of human history. A neo-liberal view of the international system we currently enjoy would support him and claim that cooperation and non-violence is the norm as nation-states have more interwoven interests that raises the cost of war to prohibitive levels. A realist, however, would disagree and see the anarchy of international disorder simply change its form -- from kinetic warfare to economic warfare, from gunpowder to the dollar.

I am interested in seeing whether it is true that the methods of conflict had simply transformed itself with the rules permitted by the neo-liberal international system, or whether the international system had in fact substantively changed its predisposition for peace. It would be a more comparative approach to trace sanction's change and continuity over time.


# Research Question: 
"Have sanctions become an instrument abused by nation-state aggressors to initiate a new front for international conflict?"


 


